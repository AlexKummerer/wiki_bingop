import pytest
from ..wikipedia_api import extract_title_from_url, set_wikipedia_language, validate_category_from_url
import wikipedia

def test_extract_title_from_url():
    url = "https://en.wikipedia.org/wiki/Python_(programming_language)"
    title = extract_title_from_url(url)
    assert title == "Python_(programming_language)"

def test_set_wikipedia_language(monkeypatch):
    def mock_set_lang(language):
        assert language == "es"

    monkeypatch.setattr(wikipedia, "set_lang", mock_set_lang)
    url = "https://es.wikipedia.org/wiki/Python"
    set_wikipedia_language(url)

def test_validate_category_from_url(monkeypatch):
    def mock_get_page_categories(title):
        return ["Programming languages", "Python"]

    monkeypatch.setattr("project.wikipedia_api.get_page_categories", mock_get_page_categories)

    url = "https://en.wikipedia.org/wiki/Python_(programming_language)"
    bingo_df = ["Programming languages"]
    valid, categories = validate_category_from_url(url, bingo_df)
    assert valid == True
    assert "Programming languages" in categories
